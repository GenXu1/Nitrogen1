}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=2,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
pdf("Blocks_fav_hap_freq.pdf",height = 3,width = 3)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=2,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=2,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
dev.off()
dev.off()
pdf("Blocks_fav_hap_freq.pdf",height = 3,width = 3)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=2,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=2,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
dev.off()
setwd("E:/UNL_Yang_lab/N_treatment_Jing/Paper_writing/pictures_tables/V2/Fig1/04haplotype_freq/V2/New-Era-Freq")
pdf("Blocks_fav_hap_freq.pdf",height = 3,width = 3)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=2,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=2,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
dev.off()
pdf("Blocks_fav_hap_freq.pdf",height = 5,width = 5)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=2,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=2,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
dev.off()
pdf("Blocks_fav_hap_freq.pdf",height = 5,width = 6)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=1,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=1,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
legend("top",legend =qq("BLK{1:6}"),pch=16,lwd=2,cex=1,col=cols,bty="n",ncol=6 )
dev.off()
pdf("Blocks_fav_hap_freq.pdf",height = 4,width = 4)
par(mar=c(4,4,2,0),mfrow=c(1,1))
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
for(i in unique(d[,1])[1])
{
d1=d[d[,1]==i,]
plot(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[1],cex=1,lwd=2,type="b",axes=F,xlab="Population",ylab="New-Era haplotype Freq",main="",ylim=c(0,1))
axis(2,tick=-0.03,las=1)
axis(1,tick=-0.03,at=1:4,labels = d1[c(4,1,3,2),2])
grid()
}
j=2
for(i in unique(d[,1])[-1])
{
d1=d[d[,1]==i,]
points(1:4,d1[c(4,1,3,2),3],pch=16,col=cols[j],cex=1,lwd=2,type="b",main="",ylim=c(0,1))
j=j+1
}
dev.off()
library(ggplot2)
d=fread("New-hap.freq.txt", header=T,data.table=F)
d=fread("New-hap.freq.txt", header=T,data.table=F)
head(d)
View(d)
d=d[d[,2]!="Teosinte" |  d[,2]!="Landrace" |  d[,2]!="New-Era"|  d[,2]!="Old-Era",]
View(d)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
View(d)
View(d)
head(d)
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
View(d)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))
+
geom_point(size=1.5)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))
?  geom_smooth
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=1)+
theme_classic()
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)+
theme_classic()
head(d)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)+
theme_classic()
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_smooth(aes(x=Era,y=Freq),method = 'lm')
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_smooth(aes(x=Era,y=Freq),method = 'lm')+
geom_point(size=1.5)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_smooth(aes(x=Era,y=Freq),method = 'lm',formula = y ~x)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_smooth(aes(x=Era,y=Freq),method = 'lm',formula = y ~x)+
geom_point(size=1.5)+
scale_color_manual(values = cols)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)
d=fread("New-hap.freq.txt", header=T,data.table=F)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)
View(d)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~1:6,linetype=2)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)+
theme_classic()
library(ggplot2)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
library(data.table)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
d$Era <- factor(d$Era,levels=c("ER60","ER70","ER80","ER90","ER00","ER10"))
d$Era
View(d)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x,linetype=2)
View(d)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))
+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
setwd("E:/UNL_Yang_lab/N_treatment_Jing/05Conbine_GWAS_Sele_GCTB_hmp/Chr5/genotype/hapmap_analysis/Wang_PVP_282_hapmap/LD_block_freq")
library(ggplot2)
d=fread("Block_Era_Fav_freq.txt", header=T,data.table=F)
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
head(d)
View(d)
setwd("E:/UNL_Yang_lab/N_treatment_Jing/Paper_writing/pictures_tables/V2/Fig1/04haplotype_freq/V2/New-Era-Freq")
library(ggplot2)
library(data.table)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
d=d[d[,2]!="Teosinte" &  d[,2]!="Landrace" &  d[,2]!="New-Era"&  d[,2]!="Old-Era",]
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
View(d)
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')
head(d)
d[,2]=as.factor(d[,2])
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=2)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm')+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))
d=fread("New-hap.freq2.txt", header=T,data.table=F)
View(d)
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)
pdf("CN_era_fav_hap_6Blks.pdf",height = 5,width = 5)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
dev.off()
dev.off()
pdf("CN_era_fav_hap_6Blks.pdf",height = 5,width = 5)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
dev.off()
d=fread("New-hap.freq2.txt", header=T,data.table=F)
re=NULL
View(d)
for(i in unique(d[,1]))
{
d1=d[d[,1]==i,]
fit=lm(d1[,3]~d1[,2],data=d1)
pval <- summary(fit)$coefficients[2,4]
r=c(i,pval)
re=rbind(re,r)
}
colnames(re)=c("Blocks","P-value")
write.table(re,file="Block_lm_P-value.txt",row.names = F,quote = F,sep="\t",col.names = T)
View(re)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
re=NULL
for(i in unique(d[,1]))
{
d1=d[d[,1]==i,]
fit=lm(d1[,3]~d1[,2],data=d1)
pval <- summary(fit)$coefficients[2,4]
r=c(i,pval)
re=rbind(re,r)
}
colnames(re)=c("Blocks","P-value")
View(re)
d=fread("New-hap.freq2.txt", header=T,data.table=F)
colnames(d)=c("Block","Era","Freq")
cols <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
cols=adjustcolor(cols,alpha.f = 0.6)
#d$Era <- factor(d$Era,levels=c("ER60","ER70","ER80","ER90","ER00","ER10"))
pdf("CN_era_fav_hap_6Blks.pdf",height = 5,width = 5)
par(mar=c(4,4,2,0),mfrow=c(1,1))
ggplot(data = d,aes(x=Era,y=Freq,colour=Block))+
geom_point(size=1.5)+
scale_color_manual(values = cols)+
geom_smooth(method = 'lm',formula = y~x)+
theme_classic()+
labs(y = "Favorable haplotype freq",
x="Era")+
ylim(0, 1)+
theme(legend.position="top")+
guides(color=guide_legend('',nrow=1,ncol=6,label.position='right'))+
scale_x_continuous(breaks = 1:6,labels=c("1960s","1970s","1980s","1990s","2000s","2010s"))+
theme(axis.text.x = element_text(size=12),axis.text.y = element_text(size=12))
dev.off()
